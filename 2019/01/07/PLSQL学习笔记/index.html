<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="PL/SQL学习笔记"><meta name="keywords" content="Oracle,Notes"><meta name="author" content="Gloria"><meta name="copyright" content="Gloria"><title>PL/SQL学习笔记 | Gloria's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '5.2.0'
} </script><meta name="generator" content="Hexo 5.2.0"></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">基础语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL99"><span class="toc-number">1.0.1.</span> <span class="toc-text">SQL99</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL"><span class="toc-number">1.0.2.</span> <span class="toc-text">SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PLsql-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">1.0.3.</span> <span class="toc-text">PLsql 是什么</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8PLSQL"><span class="toc-number">1.0.4.</span> <span class="toc-text">为什么要用PLSQL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PLsql-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">PLsql 语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%BE%E7%A4%BAPLsql%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">1.1.1.</span> <span class="toc-text">显示PLsql执行结果</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.2.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#number"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">number</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#varchar2"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">varchar2</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">属性类型</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#type"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">%type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rowtype"><span class="toc-number">1.1.3.2.</span> <span class="toc-text">%rowtype</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-type%EF%BC%8C%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-rowtype%EF%BC%9F"><span class="toc-number">1.1.3.3.</span> <span class="toc-text">何时使用%type，何时使用%rowtype？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-number">1.2.</span> <span class="toc-text">条件判断</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.2.1.</span> <span class="toc-text">基本语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%83%E4%B9%A0"><span class="toc-number">1.2.2.</span> <span class="toc-text">小练习</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B7%A5%E8%B5%84%E5%9C%A8-3000-%E6%88%96-5000"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">工资在 3000 或 5000</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#01-%E5%88%A4%E6%96%AD%E5%B7%A5%E4%BD%9C%E6%97%A5%E8%BF%98%E6%98%AF%E4%BC%91%E6%81%AF%E6%97%A5"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">01.判断工作日还是休息日</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#02-%E5%B7%A5%E8%B5%84-lt-1000%EF%BC%8C%E5%88%99%E5%9C%A8%E5%8E%9F%E6%9D%A5%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%8A%A0200%EF%BC%8C%E5%A6%82%E6%9E%9C-1000-lt-sal-lt-2000%EF%BC%8C%E5%8A%A0400%EF%BC%8C%E5%90%A6%E5%88%99-%E5%8A%A0600"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">02.工资&lt;1000，则在原来的基础上加200，如果 1000&lt;&#x3D;sal&lt;&#x3D;2000，加400，否则 加600</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.3.</span> <span class="toc-text">循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#While-%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.3.1.</span> <span class="toc-text">While 循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Loop%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.3.2.</span> <span class="toc-text">Loop循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#For%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.3.3.</span> <span class="toc-text">For循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%BB%83%E6%89%8B"><span class="toc-number">1.3.4.</span> <span class="toc-text">小练手</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#01-%E4%BD%BF%E7%94%A8loop%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%90%91emp%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A51000%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">01.使用loop循环，向emp表中插入1000条记录</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#04-%E4%BD%BF%E7%94%A8for%E5%BE%AA%E7%8E%AF%E6%98%BE%E7%A4%BA20-30"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">04.使用for循环显示20-30</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#05-%E7%9B%B4%E8%A7%92%E4%B8%89%E8%A7%92%E5%BD%A2"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">05.直角三角形</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.3.4.4.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#06-%E4%B9%9D%E4%B9%9D%E4%B9%98%E6%B3%95%E8%A1%A8"><span class="toc-number">1.3.4.5.</span> <span class="toc-text">06. 九九乘法表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#07-%E6%89%93%E5%8D%B0%E7%AD%89%E8%85%B0%E4%B8%89%E8%A7%92%E5%BD%A2"><span class="toc-number">1.3.4.6.</span> <span class="toc-text">07. 打印等腰三角形</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#08-%E6%89%93%E5%8D%B0%E8%8F%B1%E5%BD%A2"><span class="toc-number">1.3.4.7.</span> <span class="toc-text">08. 打印菱形</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#-1"><span class="toc-number">1.3.4.8.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#08-%E6%89%93%E5%8D%B0%E7%A9%BA%E5%BF%83%E8%8F%B1%E5%BD%A2%EF%BC%88%E4%BD%9C%E4%B8%9A%EF%BC%89"><span class="toc-number">1.3.4.9.</span> <span class="toc-text">08. 打印空心菱形（作业）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#-2"><span class="toc-number">1.3.4.10.</span> <span class="toc-text"></span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">1.4.</span> <span class="toc-text">游标</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">语法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#01-%E4%BD%BF%E7%94%A8%E6%97%A0%E5%8F%82%E5%85%89%E6%A0%87cursor%EF%BC%8C%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%91%98%E5%B7%A5%E7%9A%84%E5%A7%93%E5%90%8D%E5%92%8C%E5%B7%A5%E8%B5%84%E3%80%90%E5%A6%82%E6%9E%9C%E9%9C%80%E8%A6%81%E9%81%8D%E5%8E%86%E5%A4%9A%E6%9D%A1%E8%AE%B0%E5%BD%95%E6%97%B6%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%85%89%E6%A0%87cursor%EF%BC%8C%E6%97%A0%E8%AE%B0%E5%BD%95%E6%89%BE%E5%88%B0%E4%BD%BF%E7%94%A8cemp-notfound%E3%80%91"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">01.使用无参光标cursor，查询所有员工的姓名和工资【如果需要遍历多条记录时，使用光标cursor，无记录找到使用cemp%notfound】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#02-%E4%BD%BF%E7%94%A8%E5%B8%A6%E5%8F%82%E5%85%89%E6%A0%87cursor%EF%BC%8C%E6%9F%A5%E8%AF%A210%E5%8F%B7%E9%83%A8%E9%97%A8%E7%9A%84%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D%E5%92%8C%E5%B7%A5%E8%B5%84"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">02.使用带参光标cursor，查询10号部门的员工姓名和工资</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#03-%E4%BD%BF%E7%94%A8%E6%97%A0%E5%8F%82%E5%85%89%E6%A0%87cursor%EF%BC%8C%E7%9C%9F%E6%AD%A3%E7%BB%99%E5%91%98%E5%B7%A5%E6%B6%A8%E5%B7%A5%E8%B5%84%EF%BC%8CANALYST%E6%B6%A81000%EF%BC%8CMANAGER%E6%B6%A8800%EF%BC%8C%E5%85%B6%E5%AE%83%E6%B6%A8400%EF%BC%8C%E8%A6%81%E6%B1%82%E6%98%BE%E7%A4%BA%E7%BC%96%E5%8F%B7%EF%BC%8C%E5%A7%93%E5%90%8D%EF%BC%8C%E8%81%8C%E4%BD%8D%EF%BC%8C%E8%96%AA%E6%B0%B4"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">03.使用无参光标cursor，真正给员工涨工资，ANALYST涨1000，MANAGER涨800，其它涨400，要求显示编号，姓名，职位，薪水</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E3%80%81%E4%BE%8B%E5%A4%96"><span class="toc-number">1.5.</span> <span class="toc-text">异常、例外</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="toc-number">1.5.1.</span> <span class="toc-text">语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-%E9%A2%84%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B821%E4%B8%AA"><span class="toc-number">1.5.2.</span> <span class="toc-text">Oracle 预定义异常21个</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#01-%E4%BD%BF%E7%94%A8oracle%E7%B3%BB%E7%BB%9F%E5%86%85%E7%BD%AE%E4%BE%8B%E5%A4%96%EF%BC%8C%E6%BC%94%E7%A4%BA%E9%99%A40%E4%BE%8B%E5%A4%96%E3%80%90zero-divide%E3%80%91"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">01.使用oracle系统内置例外，演示除0例外【zero_divide】</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#02-%E4%BD%BF%E7%94%A8oracle%E7%B3%BB%E7%BB%9F%E5%86%85%E7%BD%AE%E4%BE%8B%E5%A4%96%EF%BC%8C%E6%9F%A5%E8%AF%A2100%E5%8F%B7%E9%83%A8%E9%97%A8%E7%9A%84%E5%91%98%E5%B7%A5%E5%A7%93%E5%90%8D%EF%BC%8C%E6%BC%94%E7%A4%BA%E6%B2%A1%E6%9C%89%E6%89%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E3%80%90no-data-found%E3%80%91"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">02.使用oracle系统内置例外，查询100号部门的员工姓名，演示没有找到数据【no_data_found】</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text">存储过程和存储函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="toc-number">2.1.</span> <span class="toc-text">语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%87%E7%A8%8B%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.1.</span> <span class="toc-text">过程的语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E8%AF%AD%E6%B3%95"><span class="toc-number">2.1.2.</span> <span class="toc-text">函数的语法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%BF%87%E7%A8%8Bhello-world"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">创建过程hello world</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9A"><span class="toc-number">2.1.3.</span> <span class="toc-text">调用过程的三种方式：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#01-%E5%88%9B%E5%BB%BA%E6%9C%89%E5%8F%82%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8BraiseSalary-%E7%BC%96%E5%8F%B7-%EF%BC%8C%E4%B8%BA7369%E5%8F%B7%E5%91%98%E5%B7%A5%E6%B6%A810-%E7%9A%84%E5%B7%A5%E8%B5%84%EF%BC%8C%E6%BC%94%E7%A4%BAin%E7%9A%84%E7%94%A8%E6%B3%95%EF%BC%8C%E9%BB%98%E8%AE%A4in%EF%BC%8C%E5%A4%A7%E5%B0%8F%E5%86%99%E4%B8%8D%E6%95%8F%E6%84%9F"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">01.创建有参存储过程raiseSalary(编号)，为7369号员工涨10%的工资，演示in的用法，默认in，大小写不敏感</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#02-%E5%88%9B%E5%BB%BA%E6%9C%89%E5%8F%82%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8BfindEmpNameAndSalAndJob-%E7%BC%96%E5%8F%B7-%EF%BC%8C%E6%9F%A5%E8%AF%A27788%E5%8F%B7%E5%91%98%E5%B7%A5%E7%9A%84%E7%9A%84%E5%A7%93%E5%90%8D%EF%BC%8C%E8%81%8C%E4%BD%8D%EF%BC%8C%E6%9C%88%E8%96%AA%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC%EF%BC%8C%E6%BC%94%E7%A4%BAout%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">02.创建有参存储过程findEmpNameAndSalAndJob(编号)，查询7788号员工的的姓名，职位，月薪，返回多个值，演示out的用法</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://7375-super-coupons-8ghqy9408b8f106f-1304374191.tcb.qcloud.la/hd.jpg?sign=d3286f9b518ac2b464abba8598225ae1&amp;t=1606968464;"></div><div class="author-info__name text-center">Gloria</div><div class="author-info__description text-center"></div><div class="follow-button"><a target="_blank" rel="noopener" href="https://github.com/mluckydream">Follow me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">17</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">16</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">17</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Gloria's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> 搜索</span></a></span></div><div id="post-info"><div id="post-title">PL/SQL学习笔记</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-07</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Database/">Database</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Database/PLSQL/">PLSQL</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2.1k</span><span class="post-meta__separator">|</span><span>阅读时长: 9 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h2><h4 id="SQL99"><a href="#SQL99" class="headerlink" title="SQL99"></a>SQL99</h4><ul>
<li>（1）<strong>是操作所有关系型数据库的规则</strong></li>
<li>（2）是第四代语言</li>
<li>（3）<strong>是一种结构化查询语言</strong></li>
<li>（4）只需发出合法合理的命令，就有对应的结果显示</li>
</ul>
<h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4><ul>
<li>（1）<strong>交互性强，非过程化</strong></li>
<li>（2）数据库操纵能力强，只需发送命令，无需关注如何实现</li>
<li>（3）多表操作时，自动导航简单</li>
<li>（4）容易调试，错误提示，直接了当</li>
<li>（5）<strong>SQL强调结果</strong></li>
</ul>
<h4 id="PLsql-是什么"><a href="#PLsql-是什么" class="headerlink" title="PLsql 是什么"></a>PLsql 是什么</h4><ul>
<li><p>是专用于Oracle服务器，在SQL基础之上，<strong>添加了一些过程化控制语句，叫PLSQL</strong></p>
</li>
<li><p>过程化包括有：类型定义，判断，循环，游标，异常或例外处理。。。</p>
</li>
<li><p><strong>PLSQL强调过程</strong></p>
</li>
</ul>
<h4 id="为什么要用PLSQL"><a href="#为什么要用PLSQL" class="headerlink" title="为什么要用PLSQL"></a>为什么要用PLSQL</h4><ul>
<li>因为SQL是第四代命令式语言，<strong>无法显示处理过程化的业务，所以得用一个过程化程序设计语言来弥补SQL的不足之处</strong>，</li>
<li>SQL和PLSQL不是替代关系，是弥补关系</li>
</ul>
<h3 id="PLsql-语法"><a href="#PLsql-语法" class="headerlink" title="PLsql 语法"></a>PLsql 语法</h3><p>declare和exception都是可以省略的，<code>begin和end;/</code>是不能省略的。</p>
<h4 id="显示PLsql执行结果"><a href="#显示PLsql执行结果" class="headerlink" title="显示PLsql执行结果"></a>显示PLsql执行结果</h4><p><code>set serveroutput on/off</code></p>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><h5 id="number"><a href="#number" class="headerlink" title="number"></a>number</h5><h5 id="varchar2"><a href="#varchar2" class="headerlink" title="varchar2"></a>varchar2</h5><h4 id="属性类型"><a href="#属性类型" class="headerlink" title="属性类型"></a>属性类型</h4><h5 id="type"><a href="#type" class="headerlink" title="%type"></a>%type</h5><h5 id="rowtype"><a href="#rowtype" class="headerlink" title="%rowtype"></a>%rowtype</h5><h5 id="何时使用-type，何时使用-rowtype？"><a href="#何时使用-type，何时使用-rowtype？" class="headerlink" title="何时使用%type，何时使用%rowtype？"></a>何时使用%type，何时使用%rowtype？</h5><ul>
<li>当定义变量时，<strong>该变量的类型与表中某字段的类型相同时，可以使用%type</strong></li>
<li>当定义变量时，该变量与整个表结构完全相同时，可以使用%rowtype，此时通过变量名.字段名，可以取值变量中对应的值</li>
<li>项目中，常用%type</li>
</ul>
<h3 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h3><h4 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h4><p><code>if 条件 then</code><br> <code>业务逻辑</code><br><code>elsif 条件 then</code><br> <code>业务逻辑</code><br><code>else</code><br> <code>业务逻辑</code><br><code>end if;</code></p>
<h4 id="小练习"><a href="#小练习" class="headerlink" title="小练习"></a>小练习</h4><h5 id="工资在-3000-或-5000"><a href="#工资在-3000-或-5000" class="headerlink" title="工资在 3000 或 5000"></a>工资在 3000 或 5000</h5><p><code>Sal in (3000,5000)</code></p>
<h5 id="01-判断工作日还是休息日"><a href="#01-判断工作日还是休息日" class="headerlink" title="01.判断工作日还是休息日"></a>01.判断工作日还是休息日</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    pday varchar2(10);</span><br><span class="line">begin</span><br><span class="line">    select to_char(sysdate,&#39;day&#39;) into pday from dual;</span><br><span class="line">    dbms_output.put_line(&#39;今天&#39;||pday);</span><br><span class="line">    if pday in (&#39;星期六&#39;,&#39;星期日&#39;) then</span><br><span class="line">    dbms_output.put_line(&#39;休息日&#39;);</span><br><span class="line">    else</span><br><span class="line">    dbms_output.put_line(&#39;工作日&#39;);</span><br><span class="line">    end if;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="02-工资-lt-1000，则在原来的基础上加200，如果-1000-lt-sal-lt-2000，加400，否则-加600"><a href="#02-工资-lt-1000，则在原来的基础上加200，如果-1000-lt-sal-lt-2000，加400，否则-加600" class="headerlink" title="02.工资&lt;1000，则在原来的基础上加200，如果 1000&lt;=sal&lt;=2000，加400，否则 加600"></a>02.工资&lt;1000，则在原来的基础上加200，如果 1000&lt;=sal&lt;=2000，加400，否则 加600</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">	  psal number(10);</span><br><span class="line">	  pempno number(10) :&#x3D; &amp;pempno;</span><br><span class="line">begin</span><br><span class="line">	  select sal into psal from emp where empno &#x3D; pempno;</span><br><span class="line">    if psal &lt; 1000 then</span><br><span class="line">    	 sal:&#x3D;sal+200;</span><br><span class="line">    elsif psal &lt; 2000 then</span><br><span class="line">    	 psal:&#x3D;sal+400;</span><br><span class="line">    else</span><br><span class="line">       sal:&#x3D;sal+600;</span><br><span class="line">    end if;</span><br><span class="line">    dbms_output.put_line(&#39;调薪后工资&#39;||psal);</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>



<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><h4 id="While-循环"><a href="#While-循环" class="headerlink" title="While 循环"></a>While 循环</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WHILE  total  &lt;&#x3D; 25000  </span><br><span class="line">LOOP</span><br><span class="line">    total : &#x3D; total + salary;</span><br><span class="line">END  LOOP;</span><br></pre></td></tr></table></figure>

<h4 id="Loop循环"><a href="#Loop循环" class="headerlink" title="Loop循环"></a>Loop循环</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Loop</span><br><span class="line">   exit [when 条件成立];</span><br><span class="line">   total:&#x3D;total+salary;</span><br><span class="line">end loop;</span><br></pre></td></tr></table></figure>

<h4 id="For循环"><a href="#For循环" class="headerlink" title="For循环"></a>For循环</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in   1 . . 3  </span><br><span class="line">loop</span><br><span class="line">语句序列 ;</span><br><span class="line">end loop ; </span><br></pre></td></tr></table></figure>

<h4 id="小练手"><a href="#小练手" class="headerlink" title="小练手"></a>小练手</h4><h5 id="01-使用loop循环，向emp表中插入1000条记录"><a href="#01-使用loop循环，向emp表中插入1000条记录" class="headerlink" title="01.使用loop循环，向emp表中插入1000条记录"></a>01.使用loop循环，向emp表中插入1000条记录</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(4) :&#x3D; 1;</span><br><span class="line">begin    </span><br><span class="line">    loop</span><br><span class="line">    		exit when i&gt;1000;</span><br><span class="line">        insert into emp(empno,ename) values(i,&#39;hello&#39;);</span><br><span class="line">        i :&#x3D; i + 1;</span><br><span class="line">    end loop;   </span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<p>#####02.使用loop循环显示1-10</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2) :&#x3D; 1;</span><br><span class="line">begin</span><br><span class="line">    loop</span><br><span class="line">        --当i&gt;10时，退出循环</span><br><span class="line">        exit when i&gt;10;</span><br><span class="line">        --输出i的值</span><br><span class="line">        dbms_output.put_line(i);</span><br><span class="line">        --变量自加</span><br><span class="line">        i :&#x3D; i + 1;  </span><br><span class="line">    end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<p>#####03.使用while循环显示1-10</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2) :&#x3D; 1;</span><br><span class="line">begin</span><br><span class="line">    while i&lt;11 </span><br><span class="line">    loop</span><br><span class="line">        dbms_output.put_line(i);</span><br><span class="line">        i :&#x3D; i + 1;</span><br><span class="line">    end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="04-使用for循环显示20-30"><a href="#04-使用for循环显示20-30" class="headerlink" title="04.使用for循环显示20-30"></a>04.使用for循环显示20-30</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2) :&#x3D; 20;</span><br><span class="line">begin</span><br><span class="line">    for i in 20 .. 30</span><br><span class="line">    loop</span><br><span class="line">        dbms_output.put_line(i);</span><br><span class="line">    end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="05-直角三角形"><a href="#05-直角三角形" class="headerlink" title="05.直角三角形"></a>05.直角三角形</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2) :&#x3D; 1;</span><br><span class="line">begin</span><br><span class="line">  for i in 1 .. 5 loop</span><br><span class="line">    for j in 1 .. i loop</span><br><span class="line">      dbms_output.put(&#39;*&#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id=""><a href="#" class="headerlink" title=""></a></h5><h5 id="06-九九乘法表"><a href="#06-九九乘法表" class="headerlink" title="06. 九九乘法表"></a>06. 九九乘法表</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2):&#x3D; 1;</span><br><span class="line">    j number(2):&#x3D; 1;</span><br><span class="line">begin</span><br><span class="line">    for i in 1 .. 9</span><br><span class="line">    loop</span><br><span class="line">    	for j in 1 .. 9</span><br><span class="line">    	</span><br><span class="line">    		loop  			      			dbms_output.put(i||&#39;*&#39;j||&#39;&#x3D;&#39;||i * j || chr*(9)&#39;	&#39;);</span><br><span class="line">    		end loop;</span><br><span class="line">      			 				dbms_output.put_line(&#39;&#39;);</span><br><span class="line">    end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="07-打印等腰三角形"><a href="#07-打印等腰三角形" class="headerlink" title="07. 打印等腰三角形"></a>07. 打印等腰三角形</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2):&#x3D;1;</span><br><span class="line">    j number(2):&#x3D;1;</span><br><span class="line">    k number(2):&#x3D;1;</span><br><span class="line">begin</span><br><span class="line">  for i in 1..5 </span><br><span class="line">  	loop</span><br><span class="line">    for j in 1 ..5-i </span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39; &#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    for k in 1 ..2*i-1 </span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39;*&#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>



<h5 id="08-打印菱形"><a href="#08-打印菱形" class="headerlink" title="08. 打印菱形"></a>08. 打印菱形</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2):&#x3D;1;</span><br><span class="line">    j number(2):&#x3D;1;</span><br><span class="line">    k number(2):&#x3D;1;</span><br><span class="line">begin</span><br><span class="line">  --上部分</span><br><span class="line">  for i in 1..5 loop</span><br><span class="line">    for j in 1 ..5-i </span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39; &#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    for k in 1 ..2*i-1 </span><br><span class="line">    loop</span><br><span class="line">       dbms_output.put(&#39;*&#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">  --下部分</span><br><span class="line">  for i in reverse 1..5 </span><br><span class="line">  loop</span><br><span class="line">    for j in 1 ..5-i</span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39; &#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    for k in 1 ..2*i-1</span><br><span class="line">    loop</span><br><span class="line">       dbms_output.put(&#39;*&#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="-1"><a href="#-1" class="headerlink" title=""></a></h5><h5 id="08-打印空心菱形（作业）"><a href="#08-打印空心菱形（作业）" class="headerlink" title="08. 打印空心菱形（作业）"></a>08. 打印空心菱形（作业）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    i number(2):&#x3D;1;</span><br><span class="line">    j number(2):&#x3D;1;</span><br><span class="line">    k number(2):&#x3D;1;</span><br><span class="line">begin</span><br><span class="line">  --上部分</span><br><span class="line">  for i in 1..5 loop</span><br><span class="line">    for j in 1 ..5-i </span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39; &#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    for k in 1 ..2*i-1 </span><br><span class="line">    loop</span><br><span class="line">    	 if k in (0,i-1)</span><br><span class="line">    	 then </span><br><span class="line">       dbms_output.put(&#39;*&#39;);</span><br><span class="line">       end if;</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">  --下部分</span><br><span class="line">  for i in reverse 1..5 </span><br><span class="line">  loop</span><br><span class="line">    for j in 1 ..5-i</span><br><span class="line">    loop</span><br><span class="line">      dbms_output.put(&#39; &#39;);</span><br><span class="line">    end loop;</span><br><span class="line">    for k in 1 ..2*i-1</span><br><span class="line">    loop</span><br><span class="line">       if k in (0,i-1)</span><br><span class="line">    	 then </span><br><span class="line">       dbms_output.put(&#39;*&#39;);</span><br><span class="line">       end if;</span><br><span class="line">    end loop;</span><br><span class="line">    dbms_output.put_line(&#39;&#39;);</span><br><span class="line">  end loop;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="-2"><a href="#-2" class="headerlink" title=""></a></h5><h3 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h3><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CURSOR  光标名  [ (参数名  数据类型[,参数名 数据类型]...)]</span><br><span class="line">      IS  SELECT   语句</span><br></pre></td></tr></table></figure>

<h5 id="01-使用无参光标cursor，查询所有员工的姓名和工资【如果需要遍历多条记录时，使用光标cursor，无记录找到使用cemp-notfound】"><a href="#01-使用无参光标cursor，查询所有员工的姓名和工资【如果需要遍历多条记录时，使用光标cursor，无记录找到使用cemp-notfound】" class="headerlink" title="01.使用无参光标cursor，查询所有员工的姓名和工资【如果需要遍历多条记录时，使用光标cursor，无记录找到使用cemp%notfound】"></a>01.使用无参光标cursor，查询所有员工的姓名和工资【如果需要遍历多条记录时，使用光标cursor，无记录找到使用cemp%notfound】</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    --定义游标</span><br><span class="line">    cursor cemp is select ename,sal from emp;</span><br><span class="line">    --定义变量</span><br><span class="line">    vename emp.ename%type;</span><br><span class="line">    vsal   emp.sal%type;</span><br><span class="line">begin</span><br><span class="line">    --打开游标，这时游标位于第一条记录之前</span><br><span class="line">    open cemp;</span><br><span class="line">    --循环</span><br><span class="line">    loop</span><br><span class="line">       --向下移动游标一次</span><br><span class="line">       fetch cemp into vename,vsal; </span><br><span class="line">       --退出循环,当游标下移一次后，找不到记录时，则退出循环</span><br><span class="line">       exit when cemp%notfound;</span><br><span class="line">       --输出结果</span><br><span class="line">       dbms_output.put_line(vename||&#39;--------&#39;||vsal);</span><br><span class="line">    end loop;</span><br><span class="line">    --关闭游标</span><br><span class="line">    close cemp;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="02-使用带参光标cursor，查询10号部门的员工姓名和工资"><a href="#02-使用带参光标cursor，查询10号部门的员工姓名和工资" class="headerlink" title="02.使用带参光标cursor，查询10号部门的员工姓名和工资"></a>02.使用带参光标cursor，查询10号部门的员工姓名和工资</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    cursor cemp(pdeptno emp.deptno%type) is select ename,sal from emp where deptno&#x3D;pdeptno;</span><br><span class="line">    pename emp.ename%type;</span><br><span class="line">    psal emp.sal%type; </span><br><span class="line">begin </span><br><span class="line">    open cemp(&amp;deptno);</span><br><span class="line">    loop</span><br><span class="line">        fetch cemp into pename,psal;     </span><br><span class="line">        exit when cemp%notfound;</span><br><span class="line">        dbms_output.put_line(pename||&#39;的薪水是&#39;||psal);</span><br><span class="line">    end loop;</span><br><span class="line">    close cemp;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h5 id="03-使用无参光标cursor，真正给员工涨工资，ANALYST涨1000，MANAGER涨800，其它涨400，要求显示编号，姓名，职位，薪水"><a href="#03-使用无参光标cursor，真正给员工涨工资，ANALYST涨1000，MANAGER涨800，其它涨400，要求显示编号，姓名，职位，薪水" class="headerlink" title="03.使用无参光标cursor，真正给员工涨工资，ANALYST涨1000，MANAGER涨800，其它涨400，要求显示编号，姓名，职位，薪水"></a>03.使用无参光标cursor，真正给员工涨工资，ANALYST涨1000，MANAGER涨800，其它涨400，要求显示编号，姓名，职位，薪水</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    cursor cemp is select empno,ename,job,sal from emp;</span><br><span class="line">    pempno emp.empno%type;</span><br><span class="line">    pename emp.ename%type;</span><br><span class="line">    pjob   emp.job%type;</span><br><span class="line">    psal   emp.sal%type;</span><br><span class="line">begin</span><br><span class="line">    open cemp;</span><br><span class="line">    loop</span><br><span class="line">        fetch cemp into pempno,pename,pjob,psal;</span><br><span class="line">        exit when cemp%notfound;</span><br><span class="line">        if pjob&#x3D;&#39;ANALYST&#39; then</span><br><span class="line">            update emp set sal &#x3D; sal + 1000 where empno &#x3D; pempno;</span><br><span class="line">        elsif pjob&#x3D;&#39;MANAGER&#39; then</span><br><span class="line">            update emp set sal &#x3D; sal + 800 where empno &#x3D; pempno;</span><br><span class="line">        else </span><br><span class="line">        update emp set sal &#x3D; sal + 400 where empno &#x3D; pempno;</span><br><span class="line">        end if;</span><br><span class="line">    end loop;</span><br><span class="line">    commit;</span><br><span class="line">    close cemp;</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h3 id="异常、例外"><a href="#异常、例外" class="headerlink" title="异常、例外"></a>异常、例外</h3><h4 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在declare节中定义例外   </span><br><span class="line">out_of   exception ;</span><br><span class="line"></span><br><span class="line"> 在begin节中可行语句中抛出例外  </span><br><span class="line">raise out_of ；</span><br><span class="line"></span><br><span class="line"> 在exception节处理例外</span><br><span class="line">when out_of then …</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="Oracle-预定义异常21个"><a href="#Oracle-预定义异常21个" class="headerlink" title="Oracle 预定义异常21个"></a>Oracle 预定义异常21个</h4><p><img src="https://img-blog.csdnimg.cn/20201008102454795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dsb3JpYV9tNjY2,size_16,color_FFFFFF,t_70#pic_center" alt="Oracle预定义异常"></p>
<h5 id="01-使用oracle系统内置例外，演示除0例外【zero-divide】"><a href="#01-使用oracle系统内置例外，演示除0例外【zero-divide】" class="headerlink" title="01.使用oracle系统内置例外，演示除0例外【zero_divide】"></a>01.使用oracle系统内置例外，演示除0例外【zero_divide】</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    myresult number;</span><br><span class="line">begin</span><br><span class="line">    myresult :&#x3D; 1&#x2F;0;</span><br><span class="line">    dbms_output.put_line(myresult);</span><br><span class="line">exception</span><br><span class="line">    when zero_divide then </span><br><span class="line">     dbms_output.put_line(&#39;除数不能为0&#39;);</span><br><span class="line">     delete from emp;  </span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>



<h5 id="02-使用oracle系统内置例外，查询100号部门的员工姓名，演示没有找到数据【no-data-found】"><a href="#02-使用oracle系统内置例外，查询100号部门的员工姓名，演示没有找到数据【no-data-found】" class="headerlink" title="02.使用oracle系统内置例外，查询100号部门的员工姓名，演示没有找到数据【no_data_found】"></a>02.使用oracle系统内置例外，查询100号部门的员工姓名，演示没有找到数据【no_data_found】</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">declare</span><br><span class="line">    pename varchar2(20);</span><br><span class="line">begin</span><br><span class="line">    select ename into pename from emp where deptno &#x3D; 100;</span><br><span class="line">    dbms_output.put_line(pename);</span><br><span class="line">exception</span><br><span class="line">    when NO_DATA_FOUND then </span><br><span class="line">     dbms_output.put_line(&#39;查无该部门员工&#39;);</span><br><span class="line">     insert into emp(empno,ename) values(1111,&#39;ERROR&#39;);</span><br><span class="line">end;</span><br><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>

<h2 id="存储过程和存储函数"><a href="#存储过程和存储函数" class="headerlink" title="存储过程和存储函数"></a>存储过程和存储函数</h2><h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><h4 id="过程的语法"><a href="#过程的语法" class="headerlink" title="过程的语法"></a>过程的语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create [or replace] procedure 过程名[(参数列表)]  </span><br><span class="line">as</span><br><span class="line">        PLSQL程序体；【begin…end;&#x2F;】</span><br></pre></td></tr></table></figure>

<h4 id="函数的语法"><a href="#函数的语法" class="headerlink" title="函数的语法"></a>函数的语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE [OR REPLACE] FUNCTION 函数名【(参数列表) 】</span><br><span class="line"> RETURN  返回值类型</span><br><span class="line">AS</span><br><span class="line">PLSQL子程序体；</span><br><span class="line"></span><br><span class="line">【begin…end;&#x2F;】</span><br></pre></td></tr></table></figure>

<p><strong>无论是过程还是函数，as关键字都代替了declare关键字。</strong></p>
<h5 id="创建过程hello-world"><a href="#创建过程hello-world" class="headerlink" title="创建过程hello world"></a>创建过程hello world</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PROCEDURE hello</span><br><span class="line">AS</span><br><span class="line">  BEGIN</span><br><span class="line">    dbms_output.put_line(&#39;hello world&#39;);</span><br><span class="line">  END;</span><br></pre></td></tr></table></figure>

<h4 id="调用过程的三种方式："><a href="#调用过程的三种方式：" class="headerlink" title="调用过程的三种方式："></a>调用过程的三种方式：</h4><ul>
<li>exec过程名【SQLPLUS中使用】</li>
<li><strong>PLSQL程序调用</strong></li>
<li>Java调用</li>
</ul>
<h5 id="01-创建有参存储过程raiseSalary-编号-，为7369号员工涨10-的工资，演示in的用法，默认in，大小写不敏感"><a href="#01-创建有参存储过程raiseSalary-编号-，为7369号员工涨10-的工资，演示in的用法，默认in，大小写不敏感" class="headerlink" title="01.创建有参存储过程raiseSalary(编号)，为7369号员工涨10%的工资，演示in的用法，默认in，大小写不敏感"></a>01.创建有参存储过程raiseSalary(编号)，为7369号员工涨10%的工资，演示in的用法，默认in，大小写不敏感</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE or REPLACE PROCEDURE bb(pempno in NUMBER)</span><br><span class="line">  AS</span><br><span class="line">  BEGIN</span><br><span class="line">    UPDATE EMP</span><br><span class="line">    SET sal &#x3D; sal * 1.2</span><br><span class="line">    WHERE empno &#x3D; pempno;</span><br><span class="line"></span><br><span class="line">  END;</span><br></pre></td></tr></table></figure>

<p>调用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BEGIN</span><br><span class="line">  bb(7369);</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<h5 id="02-创建有参存储过程findEmpNameAndSalAndJob-编号-，查询7788号员工的的姓名，职位，月薪，返回多个值，演示out的用法"><a href="#02-创建有参存储过程findEmpNameAndSalAndJob-编号-，查询7788号员工的的姓名，职位，月薪，返回多个值，演示out的用法" class="headerlink" title="02.创建有参存储过程findEmpNameAndSalAndJob(编号)，查询7788号员工的的姓名，职位，月薪，返回多个值，演示out的用法"></a>02.创建有参存储过程findEmpNameAndSalAndJob(编号)，查询7788号员工的的姓名，职位，月薪，返回多个值，演示out的用法</h5><p>创建过程：<strong>在过程中的参数，默认值是IN，如果是输出的话，那么我们要指定为OUT。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE PROCEDURE find(pempno IN NUMBER, psal OUT VARCHAR2, pename OUT VARCHAR2, pjob OUT VARCHAR2)</span><br><span class="line">AS</span><br><span class="line">  BEGIN</span><br><span class="line">    SELECT</span><br><span class="line">      ename,</span><br><span class="line">      sal,</span><br><span class="line">      job</span><br><span class="line">    INTO pename, psal, pjob</span><br><span class="line">    FROM emp</span><br><span class="line">    WHERE empno &#x3D; pempno;</span><br><span class="line">  END;</span><br></pre></td></tr></table></figure>

<p>调用：在调用的时候，使用到的psal，pname，pjob在调用的时候都没有定义的，因此我们<strong>需要先定义变量后使用！</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DECLARE</span><br><span class="line">  psal   emp.sal%TYPE;</span><br><span class="line">  pename emp.ename%TYPE;</span><br><span class="line">  pjob   emp.job%TYPE;</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">  find(7788, psal, pename, pjob);</span><br><span class="line"></span><br><span class="line">  dbms_output.put_line(psal || pename || pjob);</span><br><span class="line"></span><br><span class="line">END;&#x2F;</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Gloria</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://1inc.cn/2019/01/07/PLSQL学习笔记/">https://1inc.cn/2019/01/07/PLSQL学习笔记/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://1inc.cn">Gloria's Blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Oracle/">Oracle</a><a class="post-meta__tags" href="/tags/Notes/">Notes</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img" src="/assets/img/alipay.png"><div class="post-qr-code__desc">支付宝恰饭打赏</div></div><div class="post-qr-code-item"><img class="post-qr-code__img" src="/assets/img/wechat.png"><div class="post-qr-code__desc">微信恰饭打赏</div></div></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/08/03/SSL%E8%AF%81%E4%B9%A6%E9%85%8D%E7%BD%AE/"><i class="fa fa-chevron-left">  </i><span>SSL证书配置</span></a></div><div class="next-post pull-right"><a href="/2019/01/07/Linux%E4%B8%8BOracle%E5%AE%89%E8%A3%85/"><span>Linux下Oracle安装</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vssue-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vssue@1.4.6/dist/vssue.css"><script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vssue@1.4.6/dist/vssue.github.min.js"></script><script>var vssue = new Vue({
  el: '#vssue',
  
  data: {
    options: {
      owner: '',
      repo: '',
      clientId:'',
      clientSecret: '',
      autoCreateIssue: false,
      baseURL: '',
      perPage: 10,
      labels: [''],
    },
  },
})
vssue.render('vssue-container')</script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2020 - 2021 By Gloria</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><!--单击显示文字--> 
<script type="text/javascript" src="/js/click_show_text.js"></script>
<!--浏览器搞笑标题-->
<script type="text/javascript" src="/js/FunnyTitle.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body></html>